(function(k,f){"object"==typeof exports?module.exports=f():"function"==typeof define&&define.amd?define(f):k.Spinner=f()})(this,function(){function k(c,a){c=document.createElement(c||"div");for(var b in a)c[b]=a[b];return c}function f(c){for(var a=1,b=arguments.length;a<b;a++)c.appendChild(arguments[a]);return c}function y(c,a,b,d){var e=["opacity",a,~~(100*c),b,d].join("-");b=.01+b/d*100;d=Math.max(1-(1-c)/a*(100-b),c);var h=n.substring(0,n.indexOf("Animation")).toLowerCase();u[e]||(p.insertRule("@"+
(h&&"-"+h+"-"||"")+"keyframes "+e+"{0%{opacity:"+d+"}"+b+"%{opacity:"+c+"}"+(b+.01)+"%{opacity:1}"+(b+a)%100+"%{opacity:"+c+"}100%{opacity:"+d+"}}",p.cssRules.length),u[e]=1);return e}function q(c,a){c=c.style;var b;a=a.charAt(0).toUpperCase()+a.slice(1);for(b=0;b<v.length;b++){var d=v[b]+a;if(void 0!==c[d])return d}if(void 0!==c[a])return a}function l(c,a){for(var b in a)c.style[q(c,b)||b]=a[b];return c}function w(c){for(var a=1;a<arguments.length;a++){var b=arguments[a],d;for(d in b)void 0===c[d]&&
(c[d]=b[d])}return c}function x(c,a){return"string"==typeof c?c:c[a%c.length]}function m(c){this.opts=w(c||{},m.defaults,z)}function A(){function c(a,b){return k("<"+a+' xmlns="urn:schemas-microsoft.com:vml" class="spin-vml">',b)}p.addRule(".spin-vml","behavior:url(#default#VML)");m.prototype.lines=function(a,b){function d(){return l(c("group",{coordsize:r+" "+r,coordorigin:-h+" "+-h}),{width:r,height:r})}function e(a,e,g){f(k,f(l(d(),{rotation:360/b.lines*a+"deg",left:~~e}),f(l(c("roundrect",{arcsize:b.corners}),
{width:h,height:b.width,left:b.radius,top:-b.width>>1,filter:g}),c("fill",{color:x(b.color,a),opacity:b.opacity}),c("stroke",{opacity:0}))))}var h=b.length+b.width,r=2*h,g=2*-(b.width+b.length)+"px",k=l(d(),{position:"absolute",top:g,left:g});if(b.shadow)for(g=1;g<=b.lines;g++)e(g,-2,"progid:DXImageTransform.Microsoft.Blur(pixelradius=2,makeshadow=1,shadowopacity=.3)");for(g=1;g<=b.lines;g++)e(g);return f(a,k)};m.prototype.opacity=function(a,b,c,e){a=a.firstChild;e=e.shadow&&e.lines||0;a&&b+e<a.childNodes.length&&
(a=(a=(a=a.childNodes[b+e])&&a.firstChild)&&a.firstChild)&&(a.opacity=c)}}var v=["webkit","Moz","ms","O"],u={},n,p=function(){var c=k("style",{type:"text/css"});f(document.getElementsByTagName("head")[0],c);return c.sheet||c.styleSheet}(),z={lines:12,length:7,width:5,radius:10,rotate:0,corners:1,color:"#000",direction:1,speed:1,trail:100,opacity:.25,fps:20,zIndex:2E9,className:"spinner",top:"50%",left:"50%",position:"absolute"};m.defaults={};w(m.prototype,{spin:function(c){this.stop();var a=this,
b=a.opts,d=a.el=l(k(0,{className:b.className}),{position:b.position,width:0,zIndex:b.zIndex});l(d,{left:b.left,top:b.top});c&&c.insertBefore(d,c.firstChild||null);d.setAttribute("role","progressbar");a.lines(d,a.opts);if(!n){var e=0,h=(b.lines-1)*(1-b.direction)/2,f,g=b.fps,m=g/b.speed,p=(1-b.opacity)/(m*b.trail/100),q=m/b.lines;(function B(){e++;for(var c=0;c<b.lines;c++)f=Math.max(1-(e+(b.lines-c)*q)%m*p,b.opacity),a.opacity(d,c*b.direction+h,f,b);a.timeout=a.el&&setTimeout(B,~~(1E3/g))})()}return a},
stop:function(){var c=this.el;c&&(clearTimeout(this.timeout),c.parentNode&&c.parentNode.removeChild(c),this.el=void 0);return this},lines:function(c,a){function b(b,c){return l(k(),{position:"absolute",width:a.length+a.width+"px",height:a.width+"px",background:b,boxShadow:c,transformOrigin:"left",transform:"rotate("+~~(360/a.lines*d+a.rotate)+"deg) translate("+a.radius+"px,0)",borderRadius:(a.corners*a.width>>1)+"px"})}for(var d=0,e=(a.lines-1)*(1-a.direction)/2,h;d<a.lines;d++)h=l(k(),{position:"absolute",
top:1+~(a.width/2)+"px",transform:a.hwaccel?"translate3d(0,0,0)":"",opacity:a.opacity,animation:n&&y(a.opacity,a.trail,e+d*a.direction,a.lines)+" "+1/a.speed+"s linear infinite"}),a.shadow&&f(h,l(b("#000","0 0 4px #000"),{top:"2px"})),f(c,f(h,b(x(a.color,d),"0 0 1px rgba(0,0,0,.1)")));return c},opacity:function(c,a,b){a<c.childNodes.length&&(c.childNodes[a].style.opacity=b)}});var t=l(k("group"),{behavior:"url(#default#VML)"});!q(t,"transform")&&t.adj?A():n=q(t,"animation");return m});
